import{V as f,r as c,B as l}from"./ZcPQy5tI.js";const E=f("notification",()=>{const t=c([]),a=c(0),r=c(!1);return{notifications:t,unreadCount:a,isMock:r,loadMockNotifications:()=>{t.value=[{id:1,user_id:1,user_type:"TEACHER",title:"課程已核准",message:"您的「鋼琴基礎」課程已通過審核",is_read:!1,created_at:new Date().toISOString(),type:"APPROVAL"},{id:2,user_id:1,user_type:"TEACHER",title:"新課表提醒",message:"本週課表已更新，請查看",is_read:!1,created_at:new Date(Date.now()-36e5).toISOString(),type:"SCHEDULE"},{id:3,user_id:1,user_type:"TEACHER",title:"中心邀請",message:"「藝術中心」邀請您加入",is_read:!0,created_at:new Date(Date.now()-864e5).toISOString(),type:"CENTER_INVITE"}],a.value=2,r.value=!0},fetchNotifications:async()=>{if(!r.value)try{const s=await l().get("/notifications?limit=50");t.value=s.datas?.notifications||[],a.value=s.datas?.unread_count||0}catch(e){console.error("Failed to fetch notifications:",e)}},markAsRead:async e=>{try{await l().post(`/notifications/${e}/read`,{});const u=t.value.find(d=>d.id===e);u&&(u.is_read=!0,a.value=Math.max(0,a.value-1))}catch(s){console.error("Failed to mark as read:",s)}},markAllAsRead:async()=>{try{await l().post("/notifications/read-all",{}),t.value.forEach(s=>s.is_read=!0),a.value=0}catch(e){console.error("Failed to mark all as read:",e)}},addNotification:e=>{t.value.unshift(e),a.value++}}}),o={show:c(!1),toast:c(null)};let n=null;const i=(t,a,r=3e3)=>{n&&(clearTimeout(n),n=null),o.toast.value={type:t,message:a,visible:!0},n=setTimeout(()=>{o.toast.value=null,n=null},r)},y=()=>({show:o.show,toast:o.toast,toggle:()=>{o.show.value=!o.show.value},open:()=>{o.show.value=!0},close:()=>{o.show.value=!1},success:t=>{i("success",t)},error:t=>{i("error",t)},warning:t=>{i("warning",t)},info:t=>{i("info",t)},showSuccess:t=>{i("success",t)},showError:t=>{i("error",t)}});export{E as a,y as u};
