import{g as $,O as H,l as V,c as r,a as e,G as X,p,F as I,v as P,n,t as o,r as c,R as F,o as a,s as k,d as q,q as A}from"./Blq0K2QU.js";import{a as w}from"./CyqcL6d0.js";import{u as J}from"./A9G9iVPe.js";const W={class:"p-4 md:p-6 max-w-4xl mx-auto"},K={class:"flex gap-2 mb-6 overflow-x-auto pb-2"},Q=["onClick"],U={key:0,class:"ml-2 px-2 py-0.5 rounded-full text-xs bg-primary-500/20 text-primary-400"},Y={class:"space-y-4"},Z={key:0,class:"text-center py-12"},ee={key:1,class:"text-center py-12"},te={class:"text-slate-500"},se={class:"flex items-start justify-between mb-4"},le={class:"flex items-center gap-4"},ae={class:"text-2xl"},re={class:"text-lg font-semibold text-slate-100"},ne={class:"text-sm text-slate-400"},oe={key:0,class:"bg-white/5 rounded-lg p-4 mb-4"},ce={class:"text-slate-300 text-sm"},ie={class:"flex items-center gap-4 text-sm text-slate-400 mb-4"},ue={class:"flex items-center gap-1"},de={key:0,class:"flex items-center gap-1"},pe={key:1,class:"flex items-center gap-1"},me={key:1,class:"flex gap-3"},xe=["onClick","disabled"],fe={key:0,class:"animate-spin w-5 h-5",fill:"none",viewBox:"0 0 24 24"},ge={key:1},ve=["onClick","disabled"],he={key:0,class:"animate-spin w-5 h-5",fill:"none",viewBox:"0 0 24 24"},ye={key:1},we=$({__name:"invitations",setup(be){const B=H(),{success:L}=J(),C=B.public.apiBase,g=c(!0),i=c([]),m=c("PENDING"),u=c(null),x=c(!1),v=c("warning"),h=c(""),y=c(""),b=c(""),f=c(null),M=A(()=>[{label:"å¾…è™•ç†",value:"PENDING",count:i.value.filter(l=>l.status==="PENDING").length},{label:"å·²æŽ¥å—",value:"ACCEPTED",count:i.value.filter(l=>l.status==="ACCEPTED").length},{label:"å·²å©‰æ‹’",value:"DECLINED",count:i.value.filter(l=>l.status==="DECLINED").length},{label:"å·²éŽæœŸ",value:"EXPIRED",count:i.value.filter(l=>l.status==="EXPIRED").length},{label:"å…¨éƒ¨",value:"ALL",count:i.value.length}]),T=A(()=>m.value==="ALL"?i.value:i.value.filter(l=>l.status===m.value)),D=async()=>{g.value=!0;try{const l=localStorage.getItem("teacher_token"),s=await fetch(`${C}/teacher/me/invitations`,{headers:{Authorization:`Bearer ${l}`}});if(s.ok){const t=await s.json();i.value=t.datas||[]}}catch(l){console.error("å–å¾—é‚€è«‹åˆ—è¡¨å¤±æ•—:",l),w("è¼‰å…¥é‚€è«‹å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")}finally{g.value=!1}},N=(l,s)=>{f.value={id:l,response:s},s==="ACCEPT"?(v.value="info",h.value="æŽ¥å—é‚€è«‹",y.value="ç¢ºå®šè¦æŽ¥å—é€™å€‹é‚€è«‹å—Žï¼ŸæŽ¥å—å¾Œå°‡æˆç‚ºè©²ä¸­å¿ƒçš„åˆä½œè€å¸«ã€‚",b.value="ç¢ºå®šæŽ¥å—"):(v.value="warning",h.value="å©‰æ‹’é‚€è«‹",y.value="ç¢ºå®šè¦å©‰æ‹’é€™å€‹é‚€è«‹å—Žï¼Ÿ",b.value="ç¢ºå®šå©‰æ‹’"),x.value=!0},j=async()=>{if(!f.value)return;const{id:l,response:s}=f.value;x.value=!1,u.value=l;try{const t=localStorage.getItem("teacher_token"),d=await fetch(`${C}/teacher/me/invitations/respond`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({invitation_id:l,response:s})});if(d.ok){const _=await d.json();L(_.message||"æ“ä½œæˆåŠŸ"),await D()}else{const _=await d.json();w(_.message||"æ“ä½œå¤±æ•—")}}catch(t){console.error("å›žæ‡‰é‚€è«‹å¤±æ•—:",t),w("æ“ä½œå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")}finally{u.value=null,f.value=null}},R=l=>{switch(l){case"PENDING":return"bg-warning-500/20 text-warning-500";case"ACCEPTED":return"bg-success-500/20 text-success-500";case"DECLINED":return"bg-critical-500/20 text-critical-500";case"EXPIRED":return"bg-slate-500/20 text-slate-400";default:return"bg-slate-500/20 text-slate-400"}},z=l=>{switch(l){case"PENDING":return"å¾…è™•ç†";case"ACCEPTED":return"å·²æŽ¥å—";case"DECLINED":return"å·²å©‰æ‹’";case"EXPIRED":return"å·²éŽæœŸ";default:return l}},G=l=>{switch(l){case"TALENT_POOL":return"â­";case"TEACHER":return"ðŸ‘¨â€ðŸ«";case"MEMBER":return"ðŸŽ«";default:return"ðŸ“¬"}},O=l=>{switch(l){case"TALENT_POOL":return"äººæ‰åº«é‚€è«‹";case"TEACHER":return"è€å¸«é‚€è«‹";case"MEMBER":return"æœƒå“¡é‚€è«‹";default:return"é‚€è«‹"}},S=l=>{switch(l){case"TALENT_POOL":return"bg-yellow-500/20";case"TEACHER":return"bg-blue-500/20";case"MEMBER":return"bg-purple-500/20";default:return"bg-slate-500/20"}},E=l=>new Date(l).toLocaleDateString("zh-TW",{year:"numeric",month:"long",day:"numeric"});return V(()=>{D()}),(l,s)=>(a(),r("div",W,[s[11]||(s[11]=e("div",{class:"mb-8"},[e("h1",{class:"text-2xl md:text-3xl font-bold text-slate-100 mb-2"}," ðŸŽ é‚€è«‹é€šçŸ¥ "),e("p",{class:"text-slate-400 text-sm md:text-base"}," ç®¡ç†æ‚¨æ”¶åˆ°çš„ä¸­å¿ƒé‚€è«‹ ")],-1)),e("div",K,[(a(!0),r(I,null,P(n(M),t=>(a(),r("button",{key:t.value,onClick:d=>m.value=t.value,class:k(["px-4 py-2 rounded-lg whitespace-nowrap transition-colors",n(m)===t.value?"bg-primary-500/30 text-primary-400 border border-primary-500/50":"bg-white/5 text-slate-400 hover:bg-white/10 border border-transparent"])},[q(o(t.label)+" ",1),t.count>0?(a(),r("span",U,o(t.count),1)):p("",!0)],10,Q))),128))]),e("div",Y,[n(g)?(a(),r("div",Z,[...s[1]||(s[1]=[e("div",{class:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto mb-4"},null,-1),e("p",{class:"text-slate-400"},"è¼‰å…¥ä¸­...",-1)])])):n(T).length===0?(a(),r("div",ee,[s[2]||(s[2]=e("div",{class:"w-20 h-20 mx-auto mb-4 rounded-full bg-slate-700/50 flex items-center justify-center"},[e("svg",{class:"w-10 h-10 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})])],-1)),s[3]||(s[3]=e("h3",{class:"text-xl font-semibold text-slate-300 mb-2"},"æ²’æœ‰é‚€è«‹",-1)),e("p",te,o(n(m)==="PENDING"?"ç›®å‰æ²’æœ‰å¾…è™•ç†çš„é‚€è«‹":"æ²’æœ‰ç›¸é—œçš„é‚€è«‹è¨˜éŒ„"),1)])):(a(!0),r(I,{key:2},P(n(T),t=>(a(),r("div",{key:t.id,class:"glass-card p-6"},[e("div",se,[e("div",le,[e("div",{class:k(["w-12 h-12 rounded-xl flex items-center justify-center",S(t.invite_type)])},[e("span",ae,o(G(t.invite_type)),1)],2),e("div",null,[e("h3",re,o(t.center_name),1),e("p",ne,o(O(t.invite_type)),1)])]),e("span",{class:k(["px-3 py-1 rounded-full text-sm font-medium",R(t.status)])},o(z(t.status)),3)]),t.message?(a(),r("div",oe,[e("p",ce,o(t.message),1)])):p("",!0),e("div",ie,[e("div",ue,[s[4]||(s[4]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",null,"æ”¶åˆ°æ–¼ "+o(E(t.created_at)),1)]),t.status==="PENDING"?(a(),r("div",de,[s[5]||(s[5]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",null,"éŽæœŸæ–¼ "+o(E(t.expires_at)),1)])):p("",!0),t.responded_at?(a(),r("div",pe,[s[6]||(s[6]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),e("span",null,"å›žæ‡‰æ–¼ "+o(E(t.responded_at)),1)])):p("",!0)]),t.status==="PENDING"?(a(),r("div",me,[e("button",{onClick:d=>N(t.id,"ACCEPT"),disabled:n(u)===t.id,class:"flex-1 px-4 py-3 bg-green-500/20 border border-green-500/50 text-green-400 rounded-xl hover:bg-green-500/30 transition-colors disabled:opacity-50 flex items-center justify-center gap-2"},[n(u)===t.id?(a(),r("svg",fe,[...s[7]||(s[7]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(a(),r("span",ge,"âœ…")),s[8]||(s[8]=e("span",null,"æŽ¥å—é‚€è«‹",-1))],8,xe),e("button",{onClick:d=>N(t.id,"DECLINE"),disabled:n(u)===t.id,class:"flex-1 px-4 py-3 bg-red-500/20 border border-red-500/50 text-red-400 rounded-xl hover:bg-red-500/30 transition-colors disabled:opacity-50 flex items-center justify-center gap-2"},[n(u)===t.id?(a(),r("svg",he,[...s[9]||(s[9]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(a(),r("span",ye,"âŒ")),s[10]||(s[10]=e("span",null,"å©‰æ‹’",-1))],8,ve)])):p("",!0)]))),128))]),n(x)?(a(),X(F,{key:0,type:n(v),title:n(h),message:n(y),confirmText:n(b),cancelText:"å–æ¶ˆ",onConfirm:j,onCancel:s[0]||(s[0]=t=>x.value=!1)},null,8,["type","title","message","confirmText"])):p("",!0)]))}});export{we as default};
