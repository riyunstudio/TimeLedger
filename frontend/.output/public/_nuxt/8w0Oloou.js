import{g as z,c as i,J as O,o as a,R as G,l as P,E as q,r,a as e,b as $,G as M,p as C,w as E,n as l,S as J,s as w,d as I,t as j}from"./ZcPQy5tI.js";import{a as u}from"./DaFB5xze.js";import{u as F}from"./Ds3GEs17.js";const K={class:"glass-card"},_=z({__name:"BaseGlassCard",props:{padding:{default:"p-6"},margin:{default:"m-0"}},setup(S){return(p,f)=>(a(),i("div",K,[O(p.$slots,"default")]))}}),W={class:"p-4 md:p-6 max-w-4xl mx-auto"},X={class:"p-6"},Y={key:0,class:"text-center"},Z={class:"bg-white/5 rounded-xl p-4 mb-6"},ee={class:"space-y-3"},te={class:"flex items-center justify-between cursor-pointer"},se={class:"flex items-center justify-between cursor-pointer"},oe={key:1,class:"text-center"},le=["disabled"],ne={key:0,class:"flex items-center gap-2"},ae={key:1},re={class:"p-6"},ie={class:"flex flex-col items-center mb-6"},de={class:"bg-white p-4 rounded-xl mb-4"},ce={class:"w-48 h-48 flex items-center justify-center bg-slate-100 rounded-lg"},ue=["src"],me={key:1,class:"text-center"},xe={key:0,class:"text-center"},pe={class:"inline-flex items-center gap-3 bg-white/10 px-6 py-3 rounded-xl"},fe={class:"text-3xl font-mono font-bold text-primary-400 tracking-widest"},ve={class:"text-slate-500 text-sm mt-3"},be={class:"bg-white/5 rounded-xl p-4 text-left"},ge={class:"space-y-2 text-slate-400 text-sm"},we={class:"flex items-start gap-2"},he={class:"text-primary-400"},Ee=z({__name:"line-bind",setup(S){const p=G(),{success:f,error:R}=F(),m=p.public.apiBase;p.public.lineOfficialAccountId;const v=r(!1),h=r(!1),b=r(""),c=r(""),y=r(null),k=r(""),d=r(null),g=r(!1),B=r({isBound:!1,lineUserID:"",boundAt:null,notifyEnabled:!0,welcomeSent:!1}),n=r({newException:!0,reviewResult:!0}),L=async()=>{try{const s=localStorage.getItem("admin_token"),t=await fetch(`${m}/api/v1/admin/me/line-binding`,{headers:{Authorization:`Bearer ${s}`}});if(t.ok){const o=await t.json();B.value=o.datas,n.value={newException:o.datas.notify_enabled,reviewResult:o.datas.notify_enabled}}}catch(s){console.error("å–å¾—ç¶å®šç‹€æ…‹å¤±æ•—:",s)}},A=async s=>{try{const t=localStorage.getItem("admin_token"),o=await fetch(`${m}/api/v1/admin/me/line/qrcode-with-code?code=${s}`,{headers:{Authorization:`Bearer ${t}`}});if(o.ok){const x=await o.blob();b.value=URL.createObjectURL(x)}else console.error("å–å¾— QR Code å¤±æ•—")}catch(t){console.error("å–å¾— QR Code å¤±æ•—:",t)}},T=async()=>{v.value=!0;try{const s=localStorage.getItem("admin_token"),t=await fetch(`${m}/api/v1/admin/me/line/bind`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(t.ok){const o=await t.json();c.value=o.datas.code,y.value=new Date(o.datas.expires_at),h.value=!0,await A(o.datas.code),V(),f("å·²ç”¢ç”Ÿé©—è­‰ç¢¼ï¼Œè«‹ä½¿ç”¨ LINE æŽƒææˆ–å‚³é€é©—è­‰ç¢¼")}else{const o=await t.json();u(o.message||"åˆå§‹åŒ–ç¶å®šå¤±æ•—")}}catch(s){console.error("åˆå§‹åŒ–ç¶å®šå¤±æ•—:",s),u("åˆå§‹åŒ–ç¶å®šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")}finally{v.value=!1}},V=()=>{const s=()=>{if(!y.value)return;const t=new Date,o=y.value.getTime()-t.getTime();if(o<=0){k.value="å·²éŽæœŸ",d.value&&clearInterval(d.value);return}const x=Math.floor(o/6e4),H=Math.floor(o%6e4/1e3);k.value=`${x} åˆ† ${H} ç§’`};s(),d.value=window.setInterval(s,1e3)},Q=async()=>{try{await navigator.clipboard.writeText(c.value),f("å·²è¤‡è£½é©—è­‰ç¢¼")}catch{R("è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½")}},U=()=>{h.value=!1,c.value="",b.value="",d.value&&clearInterval(d.value)},D=async()=>{try{const s=localStorage.getItem("admin_token"),t=await fetch(`${m}/api/v1/admin/me/line/unbind`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(t.ok)f("å·²è§£é™¤ LINE ç¶å®š"),g.value=!1,await L();else{const o=await t.json();u(o.message||"è§£é™¤ç¶å®šå¤±æ•—")}}catch(s){console.error("è§£é™¤ç¶å®šå¤±æ•—:",s),u("è§£é™¤ç¶å®šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")}},N=async s=>{n.value[s]=!n.value[s];try{const t=localStorage.getItem("admin_token"),o=await fetch(`${m}/api/v1/admin/me/line/notify-settings`,{method:"PATCH",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({enabled:n.value[s]})});if(!o.ok){const x=await o.json();u(x.message||"æ›´æ–°é€šçŸ¥è¨­å®šå¤±æ•—"),n.value[s]=!n.value[s]}}catch(t){console.error("æ›´æ–°é€šçŸ¥è¨­å®šå¤±æ•—:",t),u("æ›´æ–°é€šçŸ¥è¨­å®šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦"),n.value[s]=!n.value[s]}};return P(()=>{L()}),q(()=>{d.value&&clearInterval(d.value)}),(s,t)=>(a(),i("div",W,[t[25]||(t[25]=e("div",{class:"mb-8"},[e("h1",{class:"text-2xl md:text-3xl font-bold text-slate-100 mb-2"}," ðŸ’¬ LINE é€šçŸ¥è¨­å®š "),e("p",{class:"text-slate-400 text-sm md:text-base"}," ç¶å®š LINE å¸³è™Ÿä»¥æŽ¥æ”¶å³æ™‚ä¾‹å¤–é€šçŸ¥ ")],-1)),$(_,{class:"mb-6"},{default:E(()=>[e("div",X,[l(B).isBound?(a(),i("div",Y,[t[7]||(t[7]=e("div",{class:"w-20 h-20 mx-auto mb-4 rounded-full bg-green-500/20 flex items-center justify-center"},[e("svg",{class:"w-10 h-10 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),t[8]||(t[8]=e("h2",{class:"text-xl font-bold text-slate-100 mb-2"},"å·²æˆåŠŸç¶å®š LINE",-1)),t[9]||(t[9]=e("p",{class:"text-slate-400 mb-6"}," æ‚¨å¯ä»¥æ”¶åˆ°è€å¸«æäº¤çš„ä¾‹å¤–ç”³è«‹é€šçŸ¥ ",-1)),e("div",Z,[t[6]||(t[6]=e("h3",{class:"text-sm font-medium text-slate-300 mb-4"},"é€šçŸ¥è¨­å®š",-1)),e("div",ee,[e("label",te,[t[4]||(t[4]=e("span",{class:"text-slate-300"},"æŽ¥æ”¶æ–°ä¾‹å¤–ç”³è«‹é€šçŸ¥",-1)),e("div",{class:w(["w-12 h-6 rounded-full transition-colors relative",l(n).newException?"bg-green-500":"bg-slate-600"]),onClick:t[0]||(t[0]=o=>N("newException"))},[e("div",{class:w(["absolute top-1 w-4 h-4 bg-white rounded-full transition-all",l(n).newException?"left-7":"left-1"])},null,2)],2)]),e("label",se,[t[5]||(t[5]=e("span",{class:"text-slate-300"},"æŽ¥æ”¶å¯©æ ¸çµæžœé€šçŸ¥",-1)),e("div",{class:w(["w-12 h-6 rounded-full transition-colors relative",l(n).reviewResult?"bg-green-500":"bg-slate-600"]),onClick:t[1]||(t[1]=o=>N("reviewResult"))},[e("div",{class:w(["absolute top-1 w-4 h-4 bg-white rounded-full transition-all",l(n).reviewResult?"left-7":"left-1"])},null,2)],2)])])]),e("button",{onClick:t[2]||(t[2]=o=>g.value=!0),class:"px-6 py-3 bg-red-500/20 border border-red-500/50 text-red-400 rounded-xl hover:bg-red-500/30 transition-colors"}," è§£é™¤ç¶å®š ")])):(a(),i("div",oe,[t[11]||(t[11]=e("div",{class:"w-20 h-20 mx-auto mb-4 rounded-full bg-slate-700/50 flex items-center justify-center"},[e("svg",{class:"w-10 h-10 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})])],-1)),t[12]||(t[12]=e("h2",{class:"text-xl font-bold text-slate-100 mb-2"},"å°šæœªç¶å®š LINE",-1)),t[13]||(t[13]=e("p",{class:"text-slate-400 mb-6 max-w-md mx-auto"}," ç¶å®š LINE å¾Œï¼Œç•¶è€å¸«æäº¤ä¾‹å¤–ç”³è«‹æ™‚ï¼Œæ‚¨æœƒç«‹å³æ”¶åˆ°é€šçŸ¥ï¼Œä¸å†éŒ¯éŽä»»ä½•é‡è¦ç”³è«‹ã€‚ ",-1)),e("button",{onClick:T,disabled:l(v),class:"px-8 py-3 bg-primary-500/30 border border-primary-500 text-primary-400 rounded-xl hover:bg-primary-500/40 transition-colors disabled:opacity-50"},[l(v)?(a(),i("span",ne,[...t[10]||(t[10]=[e("svg",{class:"animate-spin w-5 h-5",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),I(" è™•ç†ä¸­... ",-1)])])):(a(),i("span",ae,"é–‹å§‹ç¶å®š"))],8,le)]))])]),_:1}),l(h)?(a(),M(_,{key:0,class:"mb-6"},{default:E(()=>[e("div",re,[t[23]||(t[23]=e("h3",{class:"text-lg font-bold text-slate-100 mb-4 text-center"},"æŽƒæ QR Code ç¶å®š",-1)),e("div",ie,[e("div",de,[e("div",ce,[l(b)?(a(),i("img",{key:0,src:l(b),alt:"LINE ç¶å®š QR Code",class:"w-full h-full object-contain"},null,8,ue)):(a(),i("div",me,[...t[14]||(t[14]=[e("div",{class:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto mb-2"},null,-1),e("p",{class:"text-sm text-slate-500"},"ç”¢ç”Ÿä¸­...",-1)])]))])]),l(c)?(a(),i("div",xe,[t[16]||(t[16]=e("p",{class:"text-slate-400 mb-2"},"æˆ–å‚³é€é©—è­‰ç¢¼çµ¦ LINE å®˜æ–¹å¸³è™Ÿï¼š",-1)),e("div",pe,[e("span",fe,j(l(c)),1),e("button",{onClick:Q,class:"p-2 hover:bg-white/10 rounded-lg transition-colors",title:"è¤‡è£½é©—è­‰ç¢¼"},[...t[15]||(t[15]=[e("svg",{class:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])])]),e("p",ve," é©—è­‰ç¢¼å°‡åœ¨ "+j(l(k))+" å¾ŒéŽæœŸ ",1)])):C("",!0)]),e("div",be,[t[22]||(t[22]=e("h4",{class:"text-sm font-medium text-slate-300 mb-3"},"ç¶å®šæ­¥é©Ÿï¼š",-1)),e("ol",ge,[t[20]||(t[20]=e("li",{class:"flex items-start gap-2"},[e("span",{class:"w-5 h-5 bg-primary-500/30 text-primary-400 rounded-full flex items-center justify-center text-xs flex-shrink-0 mt-0.5"},"1"),e("span",null,"é–‹å•Ÿ LINEï¼Œæœå°‹å®˜æ–¹å¸³è™Ÿã€ŒTimeLedgerã€")],-1)),e("li",we,[t[19]||(t[19]=e("span",{class:"w-5 h-5 bg-primary-500/30 text-primary-400 rounded-full flex items-center justify-center text-xs flex-shrink-0 mt-0.5"},"2",-1)),e("span",null,[t[17]||(t[17]=I("å‚³é€é©—è­‰ç¢¼ ",-1)),e("strong",he,j(l(c)),1),t[18]||(t[18]=I(" çµ¦å®˜æ–¹å¸³è™Ÿ",-1))])]),t[21]||(t[21]=e("li",{class:"flex items-start gap-2"},[e("span",{class:"w-5 h-5 bg-primary-500/30 text-primary-400 rounded-full flex items-center justify-center text-xs flex-shrink-0 mt-0.5"},"3"),e("span",null,"å®˜æ–¹å¸³è™Ÿå›žè¦†ã€Œç¶å®šæˆåŠŸã€å³å®Œæˆ")],-1))])]),e("div",{class:"mt-6 text-center"},[e("button",{onClick:U,class:"text-slate-400 hover:text-slate-300 transition-colors"}," å–æ¶ˆç¶å®š ")])])]),_:1})):C("",!0),$(_,null,{default:E(()=>[...t[24]||(t[24]=[e("div",{class:"p-6"},[e("h3",{class:"text-lg font-bold text-slate-100 mb-4"},"LINE é€šçŸ¥ç‰¹è‰²"),e("div",{class:"grid md:grid-cols-2 gap-4"},[e("div",{class:"flex items-start gap-3"},[e("div",{class:"w-10 h-10 bg-primary-500/20 rounded-lg flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-primary-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})])]),e("div",null,[e("h4",{class:"text-slate-200 font-medium mb-1"},"å³æ™‚é€šçŸ¥"),e("p",{class:"text-slate-400 text-sm"},"è€å¸«æäº¤ä¾‹å¤–ç”³è«‹å¾Œï¼Œé¦¬ä¸Šæ”¶åˆ° LINE é€šçŸ¥")])]),e("div",{class:"flex items-start gap-3"},[e("div",{class:"w-10 h-10 bg-primary-500/20 rounded-lg flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-primary-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])]),e("div",null,[e("h4",{class:"text-slate-200 font-medium mb-1"},"ä¸€éµè™•ç†"),e("p",{class:"text-slate-400 text-sm"},"é»žæ“Šé€šçŸ¥å³å¯é–‹å•Ÿå¾Œå°ï¼Œå¿«é€Ÿè™•ç†ä¾‹å¤–ç”³è«‹")])]),e("div",{class:"flex items-start gap-3"},[e("div",{class:"w-10 h-10 bg-primary-500/20 rounded-lg flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-primary-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])]),e("div",null,[e("h4",{class:"text-slate-200 font-medium mb-1"},"å½ˆæ€§è¨­å®š"),e("p",{class:"text-slate-400 text-sm"},"å¯é¸æ“‡æ€§é–‹é—œä¸åŒé¡žåž‹çš„é€šçŸ¥")])]),e("div",{class:"flex items-start gap-3"},[e("div",{class:"w-10 h-10 bg-primary-500/20 rounded-lg flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-primary-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])]),e("div",null,[e("h4",{class:"text-slate-200 font-medium mb-1"},"å…¨å“¡é€šçŸ¥"),e("p",{class:"text-slate-400 text-sm"},"ä¸­å¿ƒæ‰€æœ‰ç®¡ç†å“¡éƒ½æœƒæ”¶åˆ°é€šçŸ¥ï¼Œéš¨æ™‚å¯è™•ç†")])])])],-1)])]),_:1}),l(g)?(a(),M(J,{key:1,type:"warning",title:"è§£é™¤ LINE ç¶å®š",message:"ç¢ºå®šè¦è§£é™¤ LINE ç¶å®šå—Žï¼Ÿè§£é™¤å¾Œå°‡ç„¡æ³•æ”¶åˆ°å³æ™‚ä¾‹å¤–é€šçŸ¥ã€‚",confirmText:"ç¢ºå®šè§£é™¤",cancelText:"å–æ¶ˆ",onConfirm:D,onCancel:t[3]||(t[3]=o=>g.value=!1)})):C("",!0)]))}});export{Ee as default};
