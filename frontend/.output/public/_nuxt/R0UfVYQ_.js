import{_}from"./Blc-h3lb.js";import{g as w,j as I,C as N,k as C,r as l,l as L,c,a as t,p as f,x as U,y as D,z as E,n as a,A as S,t as v,b as T,w as V,o as b,d as q}from"./Blq0K2QU.js";const $={class:"min-h-screen bg-gray-900 flex items-center justify-center p-4"},B={class:"bg-gray-800 p-8 rounded-lg shadow-lg w-full max-w-md border border-gray-700"},M={class:"mb-4"},R=["disabled"],j={class:"mt-6 p-4 bg-gray-700/50 rounded-lg border border-gray-600"},A={class:"space-y-2"},z={key:0,class:"mt-4 p-3 bg-red-900/50 text-red-300 rounded-lg border border-red-800"},O={key:1,class:"mt-4 p-3 bg-green-900/50 text-green-300 rounded-lg border border-green-800"},P={class:"mt-6 text-center"},J=w({__name:"login",setup(F){const g=I(),p=N(),y=C(),o=l(p.query.line_user_id||""),h=l(p.query.access_token||""),d=l(!1),r=l(""),u=l(!1),i=s=>{o.value=s,m()};async function m(){if(!o.value){r.value="è«‹è¼¸å…¥ LINE User ID";return}d.value=!0,r.value="",u.value=!1;try{const s=await $fetch("/api/v1/auth/teacher/line/login",{method:"POST",body:{line_user_id:o.value,access_token:h.value||"mock-token"}}),e=s.data||s.datas;if(s.code===0&&e){const n=e.token,k=e.user;y.login({token:n,refresh_token:"",teacher:k}),u.value=!0,setTimeout(()=>{g.push("/teacher/dashboard")},1e3)}else r.value=s?.message||"ç™»å…¥å¤±æ•—"}catch(s){console.error("Login error:",s),r.value=s.data?.message||s.message||"ç™»å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦"}finally{d.value=!1}}return L(()=>{localStorage.getItem("teacher_token")&&g.push("/teacher/dashboard")}),(s,e)=>{const x=_;return b(),c("div",$,[t("div",B,[e[7]||(e[7]=t("h1",{class:"text-2xl font-bold mb-6 text-center text-gray-100"},"è€å¸«ç™»å…¥",-1)),e[8]||(e[8]=t("div",{class:"mb-6 p-4 bg-blue-900/30 border border-blue-800 rounded-lg"},[t("p",{class:"text-sm text-blue-300"}," è«‹ä½¿ç”¨ LINE å¸³è™Ÿç™»å…¥ã€‚è¼¸å…¥æ‚¨çš„ LINE User IDã€‚ ")],-1)),t("form",{onSubmit:U(m,["prevent"])},[t("div",M,[e[4]||(e[4]=t("label",{class:"block text-gray-300 mb-2"},"LINE User ID",-1)),D(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>S(o)?o.value=n:null),type:"text",class:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"è¼¸å…¥ LINE User ID",required:""},null,512),[[E,a(o)]])]),t("button",{type:"submit",disabled:a(d),class:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 disabled:bg-gray-600 transition-colors"},v(a(d)?"ç™»å…¥ä¸­...":"ç™»å…¥"),9,R)],32),t("div",j,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-400 mb-3 text-center"},"ğŸ§ª æ¸¬è©¦å¿«é€Ÿç™»å…¥",-1)),t("div",A,[t("button",{onClick:e[1]||(e[1]=n=>i("U000000000000000000000001")),class:"w-full px-3 py-2 bg-emerald-600 hover:bg-emerald-700 text-white text-sm rounded transition-colors"}," æå°ç¾ (ç‘œä¼½è€å¸«) "),t("button",{onClick:e[2]||(e[2]=n=>i("U000000000000000000000002")),class:"w-full px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded transition-colors"}," é™³å¤§æ–‡ (å¥èº«æ•™ç·´) "),t("button",{onClick:e[3]||(e[3]=n=>i("U000000000000000000000003")),class:"w-full px-3 py-2 bg-pink-600 hover:bg-pink-700 text-white text-sm rounded transition-colors"}," ç‹å°èŠ± (èˆè¹ˆè€å¸«) ")])]),a(r)?(b(),c("div",z,v(a(r)),1)):f("",!0),a(u)?(b(),c("div",O," ç™»å…¥æˆåŠŸï¼Œæ­£åœ¨è·³è½‰... ")):f("",!0),t("div",P,[T(x,{to:"/",class:"text-blue-400 hover:text-blue-300 transition-colors"},{default:V(()=>[...e[6]||(e[6]=[q(" å›é¦–é  ",-1)])]),_:1})])])])}}});export{J as default};
