import{a as x,u as y}from"./DgepazF8.js";import{g as k,j as b,c as a,a as e,n as p,F as g,v as w,o as r,s as A,p as C,t as _,_ as E}from"./ZcPQy5tI.js";const T={class:"fixed inset-0 z-[150] pointer-events-none"},D={class:"absolute top-14 right-4 w-80 glass-card shadow-2xl pointer-events-auto animate-fade-in max-h-[70vh] overflow-hidden flex flex-col"},N={class:"flex-1 overflow-y-auto"},R={key:0,class:"p-8 text-center text-slate-500"},M={key:1,class:"divide-y divide-white/10"},I=["onClick"],S={class:"flex items-start gap-3"},$={class:"flex-1"},L={class:"font-medium text-slate-100 text-sm mb-1"},V={class:"text-sm text-slate-400"},z={class:"text-xs text-slate-500 mt-2"},B={key:0,class:"w-2 h-2 rounded-full bg-primary-500 shrink-0 mt-1"},H=k({__name:"NotificationDropdown",setup(P){const i=x(),l=y(),d=b(),f=async t=>{t.is_read||await i.markAsRead(t.id);const s=t.user_type||l.getUserType?.()||"TEACHER";t.title==="新例外申請通知"||t.type==="EXCEPTION"?s==="ADMIN"&&d.push("/admin/approval"):t.type==="REVIEW_RESULT"||t.title==="例外單審核結果"?s==="TEACHER"&&d.push("/teacher/exceptions"):t.type==="APPROVAL"&&s==="ADMIN"&&d.push("/admin/approval"),l.close()},h=async()=>{await i.markAllAsRead()},v=t=>{const s=new Date(t),n=new Date().getTime()-s.getTime(),c=Math.floor(n/(1e3*60)),m=Math.floor(n/(1e3*60*60)),u=Math.floor(n/(1e3*60*60*24));return c<1?"剛剛":c<60?`${c} 分鐘前`:m<24?`${m} 小時前`:u<7?`${u} 天前`:s.toLocaleDateString("zh-TW",{month:"short",day:"numeric"})};return(t,s)=>(r(),a("div",T,[e("div",{class:"absolute inset-0 bg-black/40 backdrop-blur-sm pointer-events-auto",onClick:s[0]||(s[0]=o=>p(l).close())}),e("div",D,[e("div",{class:"p-4 border-b border-white/10 shrink-0"},[e("div",{class:"flex items-center justify-between"},[s[1]||(s[1]=e("h3",{class:"font-semibold text-slate-100"},"通知",-1)),e("button",{onClick:h,class:"text-sm text-primary-500 hover:text-primary-400 transition-colors"}," 全部標記為已讀 ")])]),e("div",N,[p(i).notifications.length===0?(r(),a("div",R," 無通知 ")):(r(),a("div",M,[(r(!0),a(g,null,w(p(i).notifications,o=>(r(),a("div",{key:o.id,class:A(["p-4 hover:bg-white/5 transition-colors cursor-pointer",{"bg-primary-500/10":!o.is_read}]),onClick:n=>f(o)},[e("div",S,[e("div",$,[e("h4",L,_(o.title),1),e("p",V,_(o.message),1),e("p",z,_(v(o.created_at)),1)]),o.is_read?C("",!0):(r(),a("div",B))])],10,I))),128))]))])])]))}}),F=E(H,[["__scopeId","data-v-a6d80ded"]]);export{F as _};
